In this section, we will discuss the implementation of defense for our group project in detail. Our group's approach to defense includes simple defensive measures and a two part system, consisting of a honeypot and iptable rules to control traffic which will be explained below. The simple defensive measures used are only allowing users with ssh keys to connect, other than a single account that has sudo permissions and uses a strong password. The goal of the honeypot is to provide an avenue for investigation that distracts from the actual critical infrastructure. Once this unauthorized traffic occurs, the rules that we created drop the connection. This slows down or may entirely stop unauthorized users who have the intent to scan the server and try to connect or exploit it. With fake services on the honey pot, their attention will be diverted to multiple distractions. This defensive approach assumes authorized users will know what is in scope and not try to connect to or scan the honeypot.

The honeypot we chose for this project is opencanary \cite{opencanary}. Opencanary was selected because of our familiarity with it, as well as its simplicity and interoperability with the rest of the group's implementation. Opencanary integrates into the system easily because it’s built with docker, and allows our group to integrate it with our other dockerfiles seamlessly. This allows for quick configuration, and once the configuration file is set, building and running the dockerfile is quick with simple integration. The ease of deployment works perfectly for the attacks that we anticipated that were covered in the Threat Model in section \ref{Threat Model}. This will allow transferring of the honeypot to a new server to be easily handled with a single script. The ports we opened using opencanary are \texttt{8444, 8881, 33061, 2201, 63791, 3391, 50601, 1162, 1124, 1070, 8002, 2301, 14331, and 5901}

Traffic rules set by iptables include a very basic approach to discouraging traffic on the machine. The rules we have set up drop incoming traffic, preventing any connection on them. It was made easily extensible as well, with new ports simply needing to be added to a block list. All ports listed in the preceding paragraph have these rules applied to them. Opencanary has enabled a large volume of ports that seem promising to exploit. After an initial scan, the attacker would recognize these and begin to press on these attack surfaces. Unbeknownst to them, all traffic going to these ports will be dropped with no reason or message given to the attacker. Using DROP instead of REJECT provides the client no insight into why their connection is unsuccessful. On their side, it just appears that their request is hanging forever. This simple yet effective measure is a major piece of our defensive strategy. Opencanary’s large volume of unnecessary ports in tandem with these rules will cause major disruptions to any penetration attempts, guaranteeing a strong level of security for the system.


